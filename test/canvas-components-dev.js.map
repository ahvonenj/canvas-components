{"version":3,"sources":["canvas-components-util.js","canvas-components-collection.js","component-enum.js","component-events.js","component.js","button.js","checkbox.js","panel.js","radio.js","text-input.js","label.js","range-slider.js","progress-bar.js","component-label.js","component-editable-text.js","canvas-components.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CC5JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GCbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ECvLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ECvIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ECpJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ECrIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ECtIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ECrHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ECnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ECnFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ECjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"canvas-components-dev.js","sourcesContent":["// \"Static\" Canvas Component Utility Class\r\nvar CanvasComponentsUtil = \r\n{ \r\n\tdebug: true\r\n};\r\n\r\nCanvasComponentsUtil.IsUndefinedNullOrEmpty = function(variable)\r\n{\r\n\tif(typeof variable === 'undefined' ||\r\n\t\tvariable === null ||\r\n\t\tvariable === '')\r\n\t{\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nCanvasComponentsUtil.IsComponent = function(possiblyComponent)\r\n{\r\n\t// Fails after transplying\r\n\t//return Object.getPrototypeOf(possiblyComponent.constructor).name === 'Component';\r\n\treturn true;\r\n}\r\n\r\n// Component unique id generator method\r\nCanvasComponentsUtil.UUID = function()\r\n{\r\n\tfunction s4() \r\n\t{\r\n\t\treturn Math.floor((1 + Math.random()) * 0x10000)\r\n\t\t.toString(16)\r\n\t\t.substring(1);\r\n\t}\r\n\r\n\treturn s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\r\n}\r\n\r\nCanvasComponentsUtil.Log = function(str)\r\n{\r\n\tif(CanvasComponentsUtil.debug)\r\n\t\tconsole.log(str);\r\n}\r\n\r\nCanvasComponentsUtil.Timestamp = function()\r\n{\r\n\treturn window.performance && window.performance.now ? window.performance.now() : new Date().getTime();\r\n}\r\n\r\n// Basic point-rectangle collision checking method\r\nCanvasComponentsUtil.Collides = function(rect, x, y) \r\n{\r\n\tvar left = rect.x;\r\n\tvar right = rect.x + rect.w;\r\n\tvar top = rect.y;\r\n\tvar bottom = rect.y + rect.h;\r\n\r\n\tif (right >= x && left <= x && bottom >= y && top <= y) \r\n\t\treturn true;\r\n\r\n\treturn false;\r\n}\r\n\r\nvar CCUtil = CanvasComponentsUtil;","// Collection class for Canvas Components\r\nclass CanvasComponentCollection\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tthis.collection = {};\r\n\t\tthis.orderedCollection = [];\r\n\t}\r\n\r\n\t_addOrderedComponent(component)\r\n\t{\r\n\t\tthis.orderedCollection.push(component);\r\n\r\n\t\tthis.orderedCollection.sort(function(componentA, componentB)\r\n\t\t{\r\n\t\t\tif(componentA.options.z < componentB.options.z)\r\n\t\t\t\treturn -1;\r\n\r\n\t\t\tif(componentA.options.z > componentB.options.z)\r\n\t\t\t\treturn 1;\r\n\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t}\r\n\r\n\t_removeOrderedComponent(component)\r\n\t{\r\n\t\tfor(var i = 0; i < this.orderedCollection.length; i++)\r\n\t\t{\r\n\t\t\tif(this.orderedCollection[i].id === component.id)\r\n\t\t\t\tthis.orderedCollection.splice(i, 1);\r\n\t\t}\r\n\t}\r\n\t\r\n\t// Add component to the collection\r\n\tAddComponent(component)\r\n\t{\r\n\t\tif(CCUtil.IsUndefinedNullOrEmpty(component) || !CCUtil.IsComponent(component))\r\n\t\t{\r\n\t\t\tCCUtil.Log(`Add: Component is null or given component is not a component`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif(typeof this.collection[component.id] === 'undefined')\r\n\t\t{\r\n\t\t\tthis.collection[component.id] = component;\r\n\t\t\tthis._addOrderedComponent(component)\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tCCUtil.Log(`Add: ComponentCollection already has a component with id '${component.id}'`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t// Remove component from the collection\r\n\tRemoveComponent(component)\r\n\t{\r\n\t\tif(CCUtil.IsUndefinedNullOrEmpty(component) || !CCUtil.IsComponent(component))\r\n\t\t\treturn false;\r\n\r\n\t\tif(typeof this.collection[component.id] !== 'undefined')\r\n\t\t{\r\n\t\t\tthis.collection[component.id].Destroy();\r\n\t\t\tdelete this.collection[component.id];\r\n\t\t\tthis._removeOrderedComponent(component);\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tCCUtil.Log(`Remove: Could not find a component with id '${component.id}'`);\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// Find component in the collection by component\r\n\tFindComponent(component)\r\n\t{\r\n\t\tif(CCUtil.IsUndefinedNullOrEmpty(component) || !CCUtil.IsComponent(component))\r\n\t\t\treturn false;\r\n\t\t\r\n\t\tif(typeof this.collection[component.id] !== 'undefined')\r\n\t\t{\r\n\t\t\treturn this.collection[component.id];\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tCCUtil.Log(`FindComponent: Could not find a component with id '${component.id}'`);\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// Find component in the collection by a component unique id\r\n\tFindComponentById(id)\r\n\t{\r\n\t\tif(!CCUtil.IsUndefinedNullOrEmpty(id))\r\n\t\t{\r\n\t\t\tif(typeof this.collection[id] !== 'undefined')\r\n\t\t\t{\r\n\t\t\t\treturn this.collection[id];\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tCCUtil.Log(`FindComponentById: Could not find a component with id '${id}'`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// Returns a bounding box and a component ref for every component in collection\r\n\tGetBoundingBoxes()\r\n\t{\r\n\t\treturn Object.values(this.collection).map(function(component)\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tcomponent: component,\r\n\t\t\t\tBB: component._getBoundingBox()\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\t// Returns all components whose bounding box collide with given x, y\r\n\tGetComponentsAtPoint(x, y)\r\n\t{\r\n\t\treturn Object.values(this.collection).map(function(component)\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\tcomponent: component,\r\n\t\t\t\tBB: component._getBoundingBox()\r\n\t\t\t};\r\n\t\t}).filter(function(BBObject)\r\n\t\t{\r\n\t\t\treturn CCUtil.Collides(BBObject.BB, x, y);\r\n\t\t}).map(function(BBObject)\r\n\t\t{\r\n\t\t\treturn BBObject.component;\r\n\t\t});\r\n\t}\r\n\r\n\t// Returns all components\r\n\tGetComponents()\r\n\t{\r\n\t\treturn Object.values(this.collection);\r\n\t}\r\n\r\n\tGetComponentsOfType(componentType)\r\n\t{\r\n\t\treturn Object.values(this.collection).filter(component => component.ComponentType === componentType);\r\n\t}\r\n}\r\n\r\n","// Component enumeration for each available Canvas Component\r\nvar CanvasComponent = \r\n{\r\n\tBUTTON: 1,\r\n\tCHECKBOX: 2,\r\n\tPANEL: 3,\r\n\tRADIO: 4,\r\n\tTEXT_INPUT: 5,\r\n\tLABEL: 6,\r\n\r\n\tRANGE_SLIDER: 7,\r\n\tPROGRESS_BAR: 8,\r\n\r\n\r\n\tCOMPONENT_LABEL: 1000,\r\n\tCOMPONENT_EDITABLE_TEXT: 1001\r\n}","// \"Enum\" of supported Canvas Component events\r\nvar ComponentEvent =\r\n{\r\n\tCLICK: 'click',\r\n\tDOUBLE_CLICK: 'dblclick',\r\n\tMOUSE_DOWN: 'mousedown',\r\n\tMOUSE_UP: 'mouseup',\r\n\tMOUSE_ENTER: 'mouseenter',\r\n\tMOUSE_LEAVE: 'mouseleave',\r\n\tMOUSE_OVER: 'mouseover',\r\n\tMOUSE_OUT: 'mouseout',\r\n\tMOUSE_MOVE: 'mousemove',\r\n\tSCROLL: 'scroll'\r\n};","// Component superclass for all Canvas Components\r\nclass Component\r\n{\r\n\tconstructor(options, ctx, canvas, componentType)\r\n\t{\r\n\t\t// Generate unique id for the component\r\n\t\tthis.id = CCUtil.UUID();\r\n\r\n\t\t// Log error if canvas context is not given\r\n\t\tif(CCUtil.IsUndefinedNullOrEmpty(ctx))\r\n\t\t\tconsole.error('Component: Canvas context is undefined or null!');\r\n\r\n\t\tthis.ctx = ctx;\r\n\t\tthis.canvas = canvas;\r\n\t\tthis.ComponentType = componentType || null;\r\n\t\tthis.options = options;\r\n\r\n\t\tif(this.ComponentType >= 1000)\r\n\t\t\tthis.isMetaComponent = true;\r\n\t\telse\r\n\t\t\tthis.isMetaComponent = false;\r\n\r\n\t\tthis.relativeContext = null;\r\n\t\tthis.RestoreRelativeContext();\r\n\r\n\t\t// Events related attributes\r\n\t\tthis.hasFocus = false;\r\n\t\tthis.isMouseOver = false;\r\n\t\tthis.isDragged = false;\r\n\t\tthis.relativeMouseX = -99999;\r\n\t\tthis.relativeMouseY = -99999;\r\n\r\n\t\t// Custom events bound to the component\r\n\t\tthis.mouseEvents = { };\r\n\r\n\t\tCCUtil.Log(`Created component with type ${this.ComponentType}`);\r\n\t}\r\n\r\n\t// Used to bind custom events to components. Does not override default event behaviour by default.\r\n\ton(eventType, callback)\r\n\t{\r\n\t\tif(Object.values(ComponentEvent).indexOf(eventType) === -1)\r\n\t\t{\r\n\t\t\tconsole.error(`Unsupported event '${eventType}' for component`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.mouseEvents[eventType] = callback.bind(this);\r\n\t}\r\n\r\n\t// Used to unbind custom events to components.\r\n\toff(eventType, callback)\r\n\t{\r\n\t\tif(typeof this.mouseEvents[eventType] !== 'undefined')\r\n\t\t\tthis.mouseEvents[eventType] = null;\r\n\t}\r\n\r\n\t// Default component event logic\r\n\t_mouseEvent(eventType, e)\r\n\t{\r\n\t\tswitch(eventType)\r\n\t\t{\r\n\t\t\tcase ComponentEvent.CLICK:\r\n\t\t\t\tthis.hasFocus = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ComponentEvent.MOUSE_OVER:\r\n\t\t\t\tthis.isMouseOver = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ComponentEvent.MOUSE_OUT:\r\n\t\t\t\tthis.isMouseOver = false;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif(typeof this.mouseEvents[eventType] !== 'undefined' &&\r\n\t\t   typeof this.mouseEvents[eventType] !== null)\r\n\t\t{\r\n\t\t\tthis.mouseEvents[eventType](e);\r\n\t\t}\r\n\t}\r\n\r\n\t// Returns the 2D bounding box of the component\r\n\t_getBoundingBox()\r\n\t{\r\n\t\t// Radio button is circular, so calculate x, y, w, h from radius\r\n\t\tif(this.ComponentType === CanvasComponent.RADIO)\r\n\t\t{\r\n\t\t\tvar x = this.options.x - this.options.radius;\r\n\t\t\tvar y = this.options.y - this.options.radius;\r\n\t\t\tvar w = this.options.radius * 2;\r\n\t\t\tvar h = this.options.radius * 2;\r\n\t\t}\r\n\t\telse if(this.ComponentType === CanvasComponent.LABEL)\r\n\t\t{\r\n\t\t\t// WARNING: HUGE HACK (Canvas text bounding box not easy, this gives decent estimate)\r\n\t\t\t// https://stackoverflow.com/questions/1134586/how-can-you-find-the-height-of-text-on-an-html-canvas\r\n\t\t\t// https://stackoverflow.com/questions/14836350/how-to-get-the-bounding-box-of-a-text-using-html5-canvas\r\n\t\t\t// https://galactic.ink/journal/2011/01/html5-typographic-metrics/#bboxUnicode\r\n\t\t\tthis.ctx.textAlign = \"start\";\r\n\t\t\tthis.ctx.textBaseline = \"alphabetic\";\r\n\t\t\tthis.ctx.font = `${this.options.fontSize}px ${this.options.fontFamily}`;\r\n\r\n\t\t\tvar w = this.ctx.measureText(this.textContent).width;\r\n\t\t\tvar h = this.ctx.measureText('M').width;\r\n\t\t\tvar x = this.options.x;\r\n\t\t\tvar y = this.options.y - h;\t\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tvar x = this.options.x;\r\n\t\t\tvar y = this.options.y;\r\n\t\t\tvar w = this.options.width;\r\n\t\t\tvar h = this.options.height;\r\n\t\t}\r\n\r\n\t\treturn { x: x, y: y, w: w, h: h };\r\n\t}\r\n\r\n\t// Debug method. Draws a magenta bounding box border around a component when it has focus\r\n\t_drawFocus()\r\n\t{\r\n\t\t\r\n\t}\r\n\r\n\tSetRelativeContext(relativeContext)\r\n\t{\r\n\t\tthis.relativeContext = relativeContext;\r\n\t}\r\n\r\n\tRestoreRelativeContext()\r\n\t{\r\n\t\tthis.relativeContext =\r\n\t\t{\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0\r\n\t\t};\r\n\t}\r\n\r\n\t// Component draw function\r\n\tDraw()\r\n\t{\r\n\t\tif(this.hasFocus)\r\n\t\t{\r\n\t\t\tthis.ctx.strokeStyle = 'magenta';\r\n\t\t\tthis.ctx.fillStyle = 'magenta';\r\n\t\t\tthis.ctx.lineWidth = 2;\r\n\r\n\t\t\tvar bb = this._getBoundingBox();\r\n\r\n\t\t\tthis.ctx.beginPath();\r\n\r\n\t\t\tthis.ctx.rect(\r\n\t\t\t\tbb.x - 3, \r\n\t\t\t\tbb.y - 3, \r\n\t\t\t\tbb.w + 6, \r\n\t\t\t\tbb.h + 6\r\n\t\t\t);\r\n\r\n\t\t\tthis.ctx.closePath();\r\n\t\t\tthis.ctx.stroke();\r\n\t\t}\r\n\t}\r\n\r\n\t// Component update function\r\n\tUpdate(dt, mouseState)\r\n\t{\r\n\t\tif(this.isDragged)\r\n\t\t{\r\n\t\t\tthis.options.x = mouseState.x - this.relativeMouseX;\r\n\t\t\tthis.options.y = mouseState.y - this.relativeMouseY;\r\n\t\t}\r\n\t}\r\n\r\n\t// Component destroy method\r\n\tDestroy()\r\n\t{\r\n\t\t\r\n\t}\r\n}","/*\r\n\tCLASS: CanvasComponentButton (CCButton)\r\n\tDESC: Button component\r\n*/\r\nclass CCButton extends Component\r\n{\r\n\tconstructor(options, ctx, canvas)\r\n\t{\r\n\t\toptions = Object.assign(\r\n\t\t{ \r\n\t\t\twidth: 90, \r\n\t\t\theight: 28,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 1,\r\n\r\n\t\t\tborderWidth: 2,\r\n\t\t\tborderColor: '#000',\r\n\r\n\t\t\tbackgroundColor: null,\r\n\r\n\t\t\tpadding:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t},\r\n\r\n\t\t\tmargin:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t}\r\n\t\t}, options);\r\n\r\n\t\tsuper(options, ctx, canvas, CanvasComponent.BUTTON);\r\n\r\n\t\t// Default gradient shading\r\n\t\tif(this.options.backgroundColor === null)\r\n\t\t{\r\n\t\t\tvar gradient = this.ctx.createLinearGradient(\r\n\t\t\t\tthis.options.x + (this.options.width / 2), \r\n\t\t\t\tthis.options.y,\r\n\t\t\t\tthis.options.x + (this.options.width / 2),\r\n\t\t\t\tthis.options.y + this.options.height\r\n\t\t\t);\r\n\r\n\t\t\tgradient.addColorStop(0, 'rgb(244, 244, 244)');\r\n\t\t\tgradient.addColorStop(1, 'rgb(241, 241, 241');\r\n\r\n\t\t\tthis.options.backgroundColor = gradient;\r\n\t\t}\r\n\r\n\t\t// Instantiate the text of the button as a ComponentLabel\r\n\t\tthis._componentLabel = new ComponentLabel(\r\n\t\t{\r\n\t\t\tx: this.options.x + (this.options.width / 2),\r\n\t\t\ty: this.options.y + (this.options.height / 2)\r\n\t\t}, this.ctx);\r\n\t}\r\n\r\n\t// Set button text\r\n\tSetText(str)\r\n\t{\r\n\t\tthis._componentLabel.SetText(str);\r\n\t}\r\n\r\n\t// Get button text\r\n\tGetText()\r\n\t{\r\n\t\treturn this._componentLabel.GetText();\r\n\t}\r\n\r\n\t// Component update method\r\n\tUpdate(dt, mouseState)\r\n\t{\r\n\t\tthis._componentLabel.Update(dt, mouseState, this.options);\r\n\t\tsuper.Update(dt, mouseState);\r\n\t}\r\n\r\n\t// Component draw method\r\n\tDraw()\r\n\t{\r\n\t\tthis.ctx.fillStyle = this.options.backgroundColor;\r\n\t\tthis.ctx.strokeStyle = this.options.borderColor;\r\n\t\tthis.ctx.lineWidth = this.options.borderWidth;\r\n\r\n\t\tthis.ctx.beginPath();\r\n\r\n\t\tthis.ctx.rect(\r\n\t\t\tthis.relativeContext.x + this.options.x, \r\n\t\t\tthis.relativeContext.y + this.options.y, \r\n\t\t\tthis.options.width, \r\n\t\t\tthis.options.height\r\n\t\t);\r\n\r\n\t\tthis.ctx.closePath();\r\n\t\tthis.ctx.fill();\r\n\t\tthis.ctx.stroke();\r\n\r\n\t\tthis._componentLabel.SetRelativeContext(\r\n\t\t{\r\n\t\t\tx: this.relativeContext.x,\r\n\t\t\ty: this.relativeContext.y\r\n\t\t});\r\n\r\n\t\tthis._componentLabel.Draw();\r\n\r\n\t\tthis._componentLabel.RestoreRelativeContext();\r\n\r\n\t\tsuper.Draw();\r\n\t}\r\n\r\n\t// Default component event logic\r\n\t_mouseEvent(eventType, e)\r\n\t{\r\n\t\tswitch(eventType)\r\n\t\t{\r\n\t\t\tcase ComponentEvent.MOUSE_OVER:\r\n\t\t\t\tdocument.body.style.cursor = 'pointer';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ComponentEvent.MOUSE_OUT:\r\n\t\t\t\tdocument.body.style.cursor = 'default';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tsuper._mouseEvent(eventType, e);\r\n\t}\r\n}","/*\r\n\tCLASS: CanvasComponentCheckbox (CCCheckbox)\r\n\tDESC: Checkbox component\r\n*/\r\nclass CCCheckbox extends Component\r\n{\r\n\tconstructor(options, ctx, canvas)\r\n\t{\r\n\t\toptions = Object.assign(\r\n\t\t{ \r\n\t\t\twidth: 15, \r\n\t\t\theight: 15,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0,\r\n\r\n\t\t\tborderWidth: 2,\r\n\t\t\tborderColor: '#000000',\r\n\r\n\t\t\tfontSize: 8,\r\n\t\t\tfontColor: '#000',\r\n\r\n\t\t\tbackgroundColor: '#FFF',\r\n\t\t\tcheckColor: '#000',\r\n\r\n\t\t\tpadding:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t},\r\n\r\n\t\t\tmargin:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t}\r\n\t\t}, options);\r\n\r\n\t\tsuper(options, ctx, canvas, CanvasComponent.CHECKBOX);\r\n\r\n\t\tthis.group = 0;\r\n\t\tthis.state = false;\r\n\t}\r\n\r\n\tSetGroup(group)\r\n\t{\r\n\t\tthis.group = group || null;\r\n\t}\r\n\r\n\tGetGroup()\r\n\t{\r\n\t\treturn this.group;\r\n\t}\r\n\r\n\tSetState(state)\r\n\t{\r\n\t\tthis.state = state || false;\r\n\t}\r\n\r\n\tSwitchState()\r\n\t{\r\n\t\tthis.state = !this.state;\r\n\t}\r\n\r\n\tGetState()\r\n\t{\r\n\t\treturn this.state;\r\n\t}\r\n\r\n\t// Component update method\r\n\tUpdate(dt, mouseState)\r\n\t{\r\n\t\tsuper.Update(dt, mouseState);\r\n\t}\r\n\r\n\t// Component draw method\r\n\tDraw()\r\n\t{\r\n\t\tthis.ctx.fillStyle = this.options.backgroundColor;\r\n\t\tthis.ctx.strokeStyle = this.options.borderColor;\r\n\t\tthis.ctx.lineWidth = this.options.borderWidth;\r\n\r\n\t\tthis.ctx.beginPath();\r\n\r\n\t\tthis.ctx.rect(\r\n\t\t\tthis.relativeContext.x + this.options.x, \r\n\t\t\tthis.relativeContext.y + this.options.y, \r\n\t\t\tthis.options.width, \r\n\t\t\tthis.options.height\r\n\t\t);\r\n\r\n\t\tthis.ctx.closePath();\r\n\t\tthis.ctx.fill();\r\n\t\tthis.ctx.stroke();\r\n\r\n\t\tif(this.state)\r\n\t\t{\r\n\t\t\tthis.ctx.fillStyle = this.options.checkColor;\r\n\t\t\tthis.ctx.strokeStyle = this.options.checkColor;\r\n\t\t\tthis.ctx.lineWidth = this.options.borderWidth;\r\n\r\n\t\t\tthis.ctx.beginPath();\r\n\r\n\t\t\tvar checkWidth = this.options.width / 2;\r\n\t\t\tvar checkHeight = this.options.height / 2;\r\n\r\n\t\t\tthis.ctx.rect(\r\n\t\t\t\tthis.options.x + checkWidth / 2, \r\n\t\t\t\tthis.options.y + checkHeight / 2, \r\n\t\t\t\tcheckWidth, \r\n\t\t\t\tcheckHeight\r\n\t\t\t);\r\n\r\n\t\t\tthis.ctx.closePath();\r\n\t\t\tthis.ctx.fill();\r\n\t\t\tthis.ctx.stroke();\r\n\t\t}\r\n\r\n\t\tsuper.Draw();\r\n\t}\r\n\r\n\t// Default component event logic\r\n\t_mouseEvent(eventType, e)\r\n\t{\r\n\t\tswitch(eventType)\r\n\t\t{\r\n\t\t\tcase ComponentEvent.MOUSE_OVER:\r\n\t\t\t\tdocument.body.style.cursor = 'pointer';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ComponentEvent.MOUSE_OUT:\r\n\t\t\t\tdocument.body.style.cursor = 'default';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ComponentEvent.CLICK:\r\n\t\t\t\tthis.SwitchState();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tsuper._mouseEvent(eventType, e);\r\n\t}\r\n}","/*\r\n\tCLASS: CanvasComponentPanel (CCPanel)\r\n\tDESC: Panel component\r\n*/\r\nclass CCPanel extends Component\r\n{\r\n\tconstructor(options, ctx, canvas)\r\n\t{\r\n\t\toptions = Object.assign(\r\n\t\t{ \r\n\t\t\twidth: 300, \r\n\t\t\theight: 350,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0,\r\n\r\n\t\t\tborderWidth: 2,\r\n\t\t\tborderColor: '#000',\r\n\r\n\t\t\tfontSize: 8,\r\n\t\t\tfontColor: '#000',\r\n\r\n\t\t\tbackgroundColor: null,\r\n\r\n\t\t\tpadding:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t},\r\n\r\n\t\t\tmargin:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t}\r\n\t\t}, options);\r\n\r\n\t\tsuper(options, ctx, canvas, CanvasComponent.PANEL);\r\n\r\n\t\t// Default gradient shading\r\n\t\tif(this.options.backgroundColor === null)\r\n\t\t{\r\n\t\t\tvar gradient = this.ctx.createLinearGradient(\r\n\t\t\t\tthis.options.x + (this.options.width / 2), \r\n\t\t\t\tthis.options.y,\r\n\t\t\t\tthis.options.x + (this.options.width / 2),\r\n\t\t\t\tthis.options.y + this.options.height\r\n\t\t\t);\r\n\r\n\t\t\tgradient.addColorStop(0, 'rgb(244, 244, 244)');\r\n\t\t\tgradient.addColorStop(1, 'rgb(241, 241, 241');\r\n\r\n\t\t\tthis.options.backgroundColor = gradient;\r\n\t\t}\r\n\r\n\t\tthis.componentCollection = new CanvasComponentCollection();\r\n\t}\r\n\r\n\tAttachComponent(component)\r\n\t{\r\n\t\tif(this.componentCollection.AddComponent(component))\r\n\t\t\treturn component;\r\n\t\telse\r\n\t\t\treturn null;\r\n\t}\r\n\r\n\tDetachComponent(component)\r\n\t{\r\n\t\treturn this.componentCollection.RemoveComponent(component);\r\n\t}\r\n\r\n\t// Component update method\r\n\tUpdate(dt, mouseState)\r\n\t{\r\n\t\tfor(var i = 0; i < this.componentCollection.orderedCollection.length; i++)\r\n\t\t{\r\n\t\t\tthis.componentCollection.orderedCollection[i].Update();\r\n\t\t}\r\n\r\n\t\tsuper.Update(dt, mouseState);\r\n\t}\r\n\r\n\t// Component draw method\r\n\tDraw()\r\n\t{\r\n\t\tthis.ctx.fillStyle = this.options.backgroundColor;\r\n\t\tthis.ctx.strokeStyle = this.options.borderColor;\r\n\t\tthis.ctx.lineWidth = this.options.borderWidth;\r\n\r\n\t\tthis.ctx.beginPath();\r\n\r\n\t\tthis.ctx.rect(\r\n\t\t\tthis.relativeContext.x + this.options.x, \r\n\t\t\tthis.relativeContext.y + this.options.y, \r\n\t\t\tthis.options.width, \r\n\t\t\tthis.options.height\r\n\t\t);\r\n\r\n\t\tthis.ctx.closePath();\r\n\t\tthis.ctx.fill();\r\n\t\tthis.ctx.stroke();\r\n\r\n\t\t// This might work later for overflow / scrolling\r\n\t\tthis.ctx.save();\r\n\t\tthis.ctx.clip();\r\n\r\n\t\tfor(var i = 0; i < this.componentCollection.orderedCollection.length; i++)\r\n\t\t{\r\n\t\t\tthis.componentCollection.orderedCollection[i].SetRelativeContext(\r\n\t\t\t{\r\n\t\t\t\tx: this.options.x,\r\n\t\t\t\ty: this.options.y\r\n\t\t\t});\r\n\r\n\t\t\tthis.componentCollection.orderedCollection[i].Draw();\r\n\r\n\t\t\tthis.componentCollection.orderedCollection[i].RestoreRelativeContext();\r\n\t\t}\r\n\r\n\t\tthis.ctx.restore();\r\n\r\n\t\tsuper.Draw();\r\n\t}\r\n\r\n\t// Default component event logic\r\n\t_mouseEvent(eventType, e)\r\n\t{\r\n\t\tsuper._mouseEvent(eventType, e);\r\n\t}\r\n}","/*\r\n\tCLASS: CanvasComponentRadioButton (CCRadioButton)\r\n\tDESC: Radio button component\r\n*/\r\nclass CCRadioButton extends Component\r\n{\r\n\tconstructor(options, ctx, canvas)\r\n\t{\r\n\t\toptions = Object.assign(\r\n\t\t{ \r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0,\r\n\t\t\tradius: 8,\r\n\r\n\t\t\tborderWidth: 2,\r\n\t\t\tborderColor: '#000',\r\n\r\n\t\t\tfontSize: 8,\r\n\t\t\tfontColor: '#000',\r\n\r\n\t\t\tbackgroundColor: '#FFF',\r\n\t\t\tcheckColor: '#000',\r\n\r\n\t\t\tpadding:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t},\r\n\r\n\t\t\tmargin:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t}\r\n\t\t}, options);\r\n\r\n\t\tsuper(options, ctx, canvas, CanvasComponent.RADIO);\r\n\r\n\t\tthis.group = 0;\r\n\t\tthis.state = false;\r\n\t}\r\n\r\n\tSetGroup(group)\r\n\t{\r\n\t\tthis.group = group || null;\r\n\t}\r\n\r\n\tGetGroup()\r\n\t{\r\n\t\treturn this.group;\r\n\t}\r\n\r\n\tSetState(state)\r\n\t{\r\n\t\tthis.state = state || false;\r\n\t}\r\n\r\n\tSwitchState()\r\n\t{\r\n\t\tthis.state = !this.state;\r\n\t}\r\n\r\n\tGetState()\r\n\t{\r\n\t\treturn this.state;\r\n\t}\r\n\r\n\t// Component update method\r\n\tUpdate(dt, mouseState)\r\n\t{\r\n\t\tsuper.Update(dt, mouseState);\r\n\t}\r\n\r\n\t// Component draw method\r\n\tDraw()\r\n\t{\r\n\t\tthis.ctx.fillStyle = this.options.backgroundColor;\r\n\t\tthis.ctx.strokeStyle = this.options.borderColor;\r\n\t\tthis.ctx.lineWidth = this.options.borderWidth;\r\n\r\n\t\tthis.ctx.beginPath();\r\n\r\n\t\tthis.ctx.arc(this.options.x, this.options.y, this.options.radius, 0, 2 * Math.PI);\r\n\r\n\t\tthis.ctx.closePath();\r\n\t\tthis.ctx.fill();\r\n\t\tthis.ctx.stroke();\r\n\r\n\t\tif(this.state)\r\n\t\t{\r\n\t\t\tthis.ctx.fillStyle = this.options.checkColor;\r\n\t\t\tthis.ctx.strokeStyle = this.options.checkColor;\r\n\t\t\tthis.ctx.lineWidth = this.options.borderWidth;\r\n\r\n\t\t\tthis.ctx.beginPath();\r\n\r\n\t\t\tthis.ctx.arc(this.options.x, this.options.y, this.options.radius / 3, 0, 2 * Math.PI);\r\n\r\n\t\t\tthis.ctx.closePath();\r\n\t\t\tthis.ctx.fill();\r\n\t\t\tthis.ctx.stroke();\r\n\t\t}\r\n\r\n\t\tsuper.Draw();\r\n\t}\r\n\r\n\t// Default component event logic\r\n\t_mouseEvent(eventType, e)\r\n\t{\r\n\t\tswitch(eventType)\r\n\t\t{\r\n\t\t\tcase ComponentEvent.MOUSE_OVER:\r\n\t\t\t\tdocument.body.style.cursor = 'pointer';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ComponentEvent.MOUSE_OUT:\r\n\t\t\t\tdocument.body.style.cursor = 'default';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ComponentEvent.CLICK:\r\n\t\t\t\tthis.SwitchState();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tsuper._mouseEvent(eventType, e);\r\n\t}\r\n}","/*\r\n\tCLASS: CanvasComponentTextInput (CCTextInput)\r\n\tDESC: Text input component\r\n*/\r\nclass CCTextInput extends Component\r\n{\r\n\tconstructor(options, ctx, canvas)\r\n\t{\r\n\t\toptions = Object.assign(\r\n\t\t{ \r\n\t\t\twidth: 150, \r\n\t\t\theight: 21,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0,\r\n\r\n\t\t\tborderWidth: 2,\r\n\t\t\tborderColor: '#000',\r\n\r\n\t\t\tbackgroundColor: '#FFF',\r\n\r\n\t\t\tpadding:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 5\r\n\t\t\t},\r\n\r\n\t\t\tmargin:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t}\r\n\t\t}, options);\r\n\r\n\t\tsuper(options, ctx, canvas, CanvasComponent.TEXT_INPUT);\r\n\r\n\t\tthis._componentText = new ComponentEditableText(\r\n\t\t{\r\n\t\t\tx: this.options.x,\r\n\t\t\ty: this.options.y + (this.options.height / 2)\r\n\t\t}, this.ctx);\r\n\t}\r\n\r\n\t// Set text input value\r\n\tSetValue(str)\r\n\t{\r\n\t\tthis._componentText.SetValue(str);\r\n\t}\r\n\r\n\t// Get text input value\r\n\tGetValue()\r\n\t{\r\n\t\treturn this._componentText.GetValue();\r\n\t}\r\n\r\n\t// Component update method\r\n\tUpdate(dt, mouseState)\r\n\t{\r\n\t\tthis._componentText.Update(dt, mouseState, this.options);\r\n\t\tsuper.Update(dt, mouseState);\r\n\t}\r\n\r\n\t// Component draw method\r\n\tDraw()\r\n\t{\r\n\t\tthis.ctx.fillStyle = this.options.backgroundColor;\r\n\t\tthis.ctx.strokeStyle = this.options.borderColor;\r\n\t\tthis.ctx.lineWidth = this.options.borderWidth;\r\n\r\n\t\tthis.ctx.beginPath();\r\n\r\n\t\tthis.ctx.rect(\r\n\t\t\tthis.relativeContext.x + this.options.x, \r\n\t\t\tthis.relativeContext.y + this.options.y, \r\n\t\t\tthis.options.width, \r\n\t\t\tthis.options.height\r\n\t\t);\r\n\r\n\t\tthis.ctx.closePath();\r\n\t\tthis.ctx.fill();\r\n\t\tthis.ctx.stroke();\r\n\r\n\t\tthis._componentText.SetRelativeContext(\r\n\t\t{\r\n\t\t\tx: this.relativeContext.x,\r\n\t\t\ty: this.relativeContext.y\r\n\t\t});\r\n\r\n\t\tthis._componentText.Draw(this.options);\r\n\r\n\t\tthis._componentText.RestoreRelativeContext();\r\n\t\tsuper.Draw();\r\n\t}\r\n\r\n\t// Default component event logic\r\n\t_mouseEvent(eventType, e)\r\n\t{\r\n\t\tswitch(eventType)\r\n\t\t{\r\n\t\t\tcase ComponentEvent.MOUSE_OVER:\r\n\t\t\t\tdocument.body.style.cursor = 'text';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase ComponentEvent.MOUSE_OUT:\r\n\t\t\t\tdocument.body.style.cursor = 'default';\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tsuper._mouseEvent(eventType, e);\r\n\t}\r\n}","/*\r\n\tCLASS: CanvasComponentLabel (CCLabel)\r\n\tDESC: Label component\r\n*/\r\nclass CCLabel extends Component\r\n{\r\n\tconstructor(options, ctx, canvas)\r\n\t{\r\n\t\toptions = Object.assign(\r\n\t\t{ \r\n\t\t\twidth: 150, \r\n\t\t\theight: 35,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0,\r\n\r\n\t\t\tborderWidth: 1,\r\n\t\t\tborderColor: '#000',\r\n\r\n\t\t\tfontSize: 16,\r\n\t\t\tfontColor: '#000',\r\n\t\t\tfontFamily: 'Arial',\r\n\r\n\t\t\tbackgroundColor: '#FFF',\r\n\r\n\t\t\tpadding:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t},\r\n\r\n\t\t\tmargin:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t}\r\n\t\t}, options);\r\n\r\n\t\tsuper(options, ctx, canvas, CanvasComponent.LABEL);\r\n\r\n\t\tthis.textContent = '';\r\n\t}\r\n\r\n\tSetText(str)\r\n\t{\r\n\t\tthis.textContent = str;\r\n\t}\r\n\r\n\t// Component update method\r\n\tUpdate(dt, mouseState)\r\n\t{\r\n\t\tsuper.Update(dt, mouseState);\r\n\t}\r\n\r\n\t// Component draw method\r\n\tDraw()\r\n\t{\r\n\t\tthis.ctx.textAlign = \"start\";\r\n\t\tthis.ctx.textBaseline = \"alphabetic\";\r\n\t\tthis.ctx.fillStyle = this.options.fontColor;\r\n\t\tthis.ctx.strokeStyle = this.options.fontColor;\r\n\t\tthis.ctx.font = `${this.options.fontSize}px ${this.options.fontFamily}`;\r\n\r\n\t\tthis.ctx.beginPath();\r\n\t\tthis.ctx.fillText(\r\n\t\t\tthis.textContent, \r\n\t\t\tthis.relativeContext.x + this.options.x, \r\n\t\t\tthis.relativeContext.y + this.options.y\r\n\t\t);\r\n\t\tthis.ctx.closePath();\r\n\r\n\t\tsuper.Draw();\r\n\t}\r\n\r\n\t// Default component event logic\r\n\t_mouseEvent(eventType, e)\r\n\t{\r\n\t\tsuper._mouseEvent(eventType, e);\r\n\t}\r\n}","/*\r\n\tCLASS: CanvasComponentRangeSlider (CCRangeSlider)\r\n\tDESC: Range slider component\r\n*/\r\nclass CCRangeSlider extends Component\r\n{\r\n\tconstructor(options, ctx, canvas)\r\n\t{\r\n\t\toptions = Object.assign(\r\n\t\t{ \r\n\t\t\twidth: 200, \r\n\t\t\theight: 50,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0,\r\n\r\n\t\t\tborderWidth: 1,\r\n\t\t\tborderColor: '#000',\r\n\r\n\t\t\tfontSize: 8,\r\n\t\t\tfontColor: '#000',\r\n\r\n\t\t\tbackgroundColor: '#FFF',\r\n\r\n\t\t\tpadding:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t},\r\n\r\n\t\t\tmargin:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t}\r\n\t\t}, options);\r\n\r\n\t\tsuper(options, ctx, canvas, CanvasComponent.RANGE_SLIDER);\r\n\t}\r\n\r\n\t// Component update method\r\n\tUpdate(dt, mouseState)\r\n\t{\r\n\t\tsuper.Update(dt, mouseState);\r\n\t}\r\n\r\n\t// Component draw method\r\n\tDraw()\r\n\t{\r\n\t\tsuper.Draw();\r\n\t}\r\n\r\n\t// Default component event logic\r\n\t_mouseEvent(eventType, e)\r\n\t{\r\n\t\tsuper._mouseEvent(eventType, e);\r\n\t}\r\n}","/*\r\n\tCLASS: CanvasComponentProgressBar (CCProgressBar)\r\n\tDESC: Progress bar component\r\n*/\r\nclass CCProgressBar extends Component\r\n{\r\n\tconstructor(options, ctx, canvas)\r\n\t{\r\n\t\toptions = Object.assign(\r\n\t\t{ \r\n\t\t\twidth: 200, \r\n\t\t\theight: 50,\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0,\r\n\r\n\t\t\tborderWidth: 1,\r\n\t\t\tborderColor: '#000',\r\n\r\n\t\t\tfontSize: 8,\r\n\t\t\tfontColor: '#000',\r\n\r\n\t\t\tbackgroundColor: '#FFF',\r\n\r\n\t\t\tpadding:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t},\r\n\r\n\t\t\tmargin:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t}\r\n\t\t}, options);\r\n\r\n\t\tsuper(options, ctx, canvas, CanvasComponent.PROGRESS_BAR);\r\n\t}\r\n\r\n\t// Component update method\r\n\tUpdate(dt, mouseState)\r\n\t{\r\n\t\tsuper.Update(dt, mouseState);\r\n\t}\r\n\r\n\t// Component draw method\r\n\tDraw()\r\n\t{\r\n\t\tsuper.Draw();\r\n\t}\r\n\r\n\t// Default component event logic\r\n\t_mouseEvent(eventType, e)\r\n\t{\r\n\t\tsuper._mouseEvent(eventType, e);\r\n\t}\r\n}","/*\r\n\tCLASS: ComponentLabel\r\n\tDESC: Meta label component\r\n*/\r\nclass ComponentLabel extends Component\r\n{\r\n\tconstructor(options, ctx, canvas, parentComponent)\r\n\t{\r\n\t\toptions = Object.assign(\r\n\t\t{ \r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0,\r\n\r\n\t\t\tfontSize: 12,\r\n\t\t\tfontColor: '#000',\r\n\t\t\tfontFamily: 'Arial',\r\n\r\n\t\t\tpadding:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t},\r\n\r\n\t\t\tmargin:\r\n\t\t\t{\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tleft: 0\r\n\t\t\t}\r\n\t\t}, options);\r\n\r\n\t\tsuper(options, ctx, canvas, CanvasComponent.COMPONENT_LABEL);\r\n\r\n\t\t/*if(CCUtil.IsUndefinedNullOrEmpty(parentComponent))\r\n\t\t\tCCUtil.Log(`Parent component could not be inherited for ComponentLabel#${this.id}`);\r\n\r\n\t\tthis.parentComponent = parentComponent;*/\r\n\t\tthis.textContent = '';\r\n\t}\r\n\r\n\t// Set component label text\r\n\tSetText(str)\r\n\t{\r\n\t\tthis.textContent = str;\r\n\t}\r\n\r\n\t// Get component label text\r\n\tGetText()\r\n\t{\r\n\t\treturn this.textContent;\r\n\t}\r\n\r\n\t// Component update method\r\n\tUpdate(dt, mouseState, parentOptions)\r\n\t{\r\n\t\t//super.Update(dt, mouseState);\r\n\t\tthis.options.x = parentOptions.x + (parentOptions.width / 2),\r\n\t\tthis.options.y = parentOptions.y + (parentOptions.height / 2)\r\n\t}\r\n\r\n\t// Component draw method\r\n\tDraw()\r\n\t{\r\n\t\tthis.ctx.textAlign = \"center\";\r\n\t\tthis.ctx.textBaseline = \"middle\";\r\n\t\tthis.ctx.fillStyle = this.options.fontColor;\r\n\t\tthis.ctx.strokeStyle = this.options.fontColor;\r\n\t\tthis.ctx.font = `${this.options.fontSize}px ${this.options.fontFamily}`;\r\n\r\n\t\tthis.ctx.beginPath();\r\n\t\tthis.ctx.fillText(\r\n\t\t\tthis.textContent, \r\n\t\t\tthis.relativeContext.x + this.options.x, \r\n\t\t\tthis.relativeContext.y + this.options.y\r\n\t\t);\r\n\t\tthis.ctx.closePath();\r\n\r\n\t\tsuper.Draw();\r\n\t}\r\n}","/*\r\n\tCLASS: ComponentLabel\r\n\tDESC: Meta label component\r\n*/\r\nclass ComponentEditableText extends Component\r\n{\r\n\tconstructor(options, ctx, canvas, parentComponent)\r\n\t{\r\n\t\toptions = Object.assign(\r\n\t\t{ \r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0,\r\n\r\n\t\t\tfontSize: 12,\r\n\t\t\tfontColor: '#000',\r\n\t\t\tfontFamily: 'Arial'\r\n\t\t}, options);\r\n\r\n\t\tsuper(options, ctx, canvas, CanvasComponent.COMPONENT_EDITABLE_TEXT);\r\n\r\n\t\tthis.value = '';\r\n\t}\r\n\r\n\t// Set editable text value\r\n\tSetValue(str)\r\n\t{\r\n\t\tthis.value = str;\r\n\t}\r\n\r\n\t// Get editable text value\r\n\tGetValue()\r\n\t{\r\n\t\treturn this.value;\r\n\t}\r\n\r\n\t// Component update method\r\n\tUpdate(dt, mouseState, parentOptions)\r\n\t{\r\n\t\t//super.Update(dt, mouseState);\r\n\t\tthis.options.x = parentOptions.x;\r\n\t\tthis.options.y = parentOptions.y + (parentOptions.height / 2);\r\n\t}\r\n\r\n\t// Component draw method\r\n\tDraw(parentOptions)\r\n\t{\r\n\t\tparentOptions = parentOptions || { padding: { left: 0 } };\r\n\r\n\t\tthis.ctx.textAlign = \"start\";\r\n\t\tthis.ctx.textBaseline = \"middle\";\r\n\t\tthis.ctx.fillStyle = this.options.fontColor;\r\n\t\tthis.ctx.strokeStyle = this.options.fontColor;\r\n\t\tthis.ctx.font = `${this.options.fontSize}px ${this.options.fontFamily}`;\r\n\r\n\t\tthis.ctx.beginPath();\r\n\t\tthis.ctx.fillText(\r\n\t\t\tthis.value, \r\n\t\t\tthis.relativeContext.x + this.options.x + parentOptions.padding.left, \r\n\t\t\tthis.relativeContext.y + this.options.y\r\n\t\t);\r\n\t\tthis.ctx.closePath();\r\n\r\n\t\tsuper.Draw();\r\n\t}\r\n}","// Main class for Canvas Components\r\nclass ComponentCanvas\r\n{\r\n\tconstructor(canvasselector, stats)\r\n\t{\r\n\t\tif(CCUtil.IsUndefinedNullOrEmpty(canvasselector))\r\n\t\t{\r\n\t\t\tconsole.error('ComponentCanvas: Invalid selector ' + canvasselector);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.canvasselector = canvasselector;\r\n\r\n\t\tif(document.querySelector(this.canvasselector) === null)\r\n\t\t{\r\n\t\t\tconsole.error('ComponentCanvas: Could not get canvas ' + this.canvasselector);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Fps counter\r\n\t\tthis.stats = stats || null;\r\n\r\n\t\t// Canvas attributes\r\n\t\tthis.canvas = document.querySelector(this.canvasselector);\r\n\t\tthis.ctx = this.canvas.getContext('2d');\r\n\t\tthis.canvasWidth = this.canvas.width;\r\n\t\tthis.canvasHeight = this.canvas.height;\r\n\r\n\t\t// Instantiate CanvasComponentCollection to hold the components in\r\n\t\tthis.CanvasComponentCollection = new CanvasComponentCollection();\r\n\r\n\t\t// Main update and draw loop timing setup\r\n\t\tthis.t = \r\n\t\t{\r\n\t\t\tnow: null,\r\n\t\t\tacc: 0,\r\n\t\t\tdt: 0.01,\r\n\t\t\tlast: 0,\r\n\t\t\tstep: 1/60,\r\n\t\t\ttime: 0,\r\n\t\t\tft: 0\r\n\t\t}\r\n\r\n\t\t// Bind all the native event listeners and screw them up later with cool custom things\r\n\t\tthis.canvas.addEventListener('click', this.e_onClick.bind(this));\r\n\t\tthis.canvas.addEventListener('dblclick', this.e_onDblClick.bind(this));\r\n\t\tthis.canvas.addEventListener('mousedown', this.e_mouseDown.bind(this));\r\n\t\tthis.canvas.addEventListener('mouseup', this.e_mouseUp.bind(this));\r\n\t\tthis.canvas.addEventListener('mouseenter', this.e_mouseEnter.bind(this));\r\n\t\tthis.canvas.addEventListener('mouseleave', this.e_mouseLeave.bind(this));\r\n\t\tthis.canvas.addEventListener('mouseover', this.e_mouseOver.bind(this));\r\n\t\tthis.canvas.addEventListener('mouseout', this.e_mouseOut.bind(this));\r\n\t\tthis.canvas.addEventListener('mousemove', this.e_mouseMove.bind(this));\r\n\t\tthis.canvas.addEventListener('scroll', this.e_mouseScroll.bind(this));\r\n\r\n\t\t// Event related attributes\r\n\t\tthis.mouseState = \r\n\t\t{\r\n\t\t\tlx: -99999,\t\t// Mouse last x\r\n\t\t\tly: -99999,\t\t// Mouse last y\r\n\t\t\tx: -99999,\t\t// Mouse x\r\n\t\t\ty: -99999,\t\t// Mouse y\r\n\t\t\tdx: -99999,\t\t// Mouse delta x\r\n\t\t\tdy: -99999,\t\t// Mouse delta y\r\n\t\t\tldx: -99999,\t// Last down x\r\n\t\t\tldy: -99999,\t// Last down y\r\n\r\n\t\t\tisDown: false,\r\n\r\n\t\t\tdownStartTime: 0,\r\n\t\t\tdownElapsedTime: 0,\r\n\t\t\tdragEventFired: false\r\n\t\t};\r\n\r\n\t\tthis.componentsDragged = [];\r\n\r\n\t\t// Start main update and draw loop\r\n\t\tthis.Loop();\r\n\t}\r\n\r\n\t// Main component creation method\r\n\tCreateComponent(componentType, options, addToCollection = true)\r\n\t{\r\n\t\tvar component = null;\r\n\r\n\t\t// Meta component, skip\r\n\t\tif(componentType >= 1000)\r\n\t\t{\r\n\t\t\tCCUtil.Log(`CreateComponent: Trying to instantiate Meta Component, ignoring`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tswitch(componentType)\r\n\t\t{\r\n\t\t\tcase CanvasComponent.BUTTON:\r\n\t\t\t\tcomponent = new CCButton(options, this.ctx);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase CanvasComponent.CHECKBOX:\r\n\t\t\t\tcomponent = new CCCheckbox(options, this.ctx);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase CanvasComponent.PANEL:\r\n\t\t\t\tcomponent = new CCPanel(options, this.ctx);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase CanvasComponent.RADIO:\r\n\t\t\t\tcomponent = new CCRadioButton(options, this.ctx);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase CanvasComponent.TEXT_INPUT:\r\n\t\t\t\tcomponent = new CCTextInput(options, this.ctx);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase CanvasComponent.LABEL:\r\n\t\t\t\tcomponent = new CCLabel(options, this.ctx);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase CanvasComponent.RANGE_SLIDER:\r\n\t\t\t\tcomponent = new CCRangeSlider(options, this.ctx);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase CanvasComponent.PROGRESS_BAR:\r\n\t\t\t\tcomponent = new CCProgressBar(options, this.ctx);\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tCCUtil.Log(`CreateComponent: Component creation failed (${componentType})`);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif(addToCollection)\r\n\t\t{\r\n\t\t\t// Returns the component or false\r\n\t\t\treturn this.AddComponent(component);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\treturn component;\r\n\t\t}\r\n\t}\r\n\r\n\t// Same as CreateComponent, but does not add it to any collection\r\n\tBuildComponent(componentType, options)\r\n\t{\r\n\t\treturn this.CreateComponent(componentType, options, false);\r\n\t}\r\n\r\n\tGetContext()\r\n\t{\r\n\t\treturn this.ctx;\r\n\t}\r\n\r\n\t// Actually the main loop\r\n\tLoop()\r\n\t{\r\n\t\t// Begin fps measurement\r\n\t\tthis.stats.begin();\t\r\n\r\n\t\tthis.t.now = CCUtil.Timestamp();\r\n\t\tthis.t.ft = this.t.now - this.t.last;\r\n\r\n\t\tif(this.t.ft > 0.25)\r\n\t\t\tthis.t.ft = 0.25;\r\n\r\n\t\tthis.t.last = this.t.now; \r\n\t\tthis.t.acc += this.t.ft;\r\n\r\n\t\twhile(this.t.acc >= this.t.dt) \r\n\t\t{\r\n\t\t\tthis.Update(this.t.dt);\r\n\t\t\t\r\n\t\t\tthis.t.time += this.t.dt;\r\n\t\t\tthis.t.acc -= this.t.dt;\r\n\t\t}\r\n\r\n\t\tthis.Draw();\r\n\r\n\t\t// End fps measurement\r\n\t\tthis.stats.end();\r\n\r\n\t\trequestAnimationFrame(function() { this.Loop(); }.bind(this));\r\n\t}\r\n\r\n\t// Main component draw method and loop\r\n\tDraw()\r\n\t{\r\n\t\t// Clear the canvas, optimize later if enough brain\r\n\t\tthis.ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\r\n\r\n\t\t// Draw everything\r\n\t\tfor(var i = 0; i < this.CanvasComponentCollection.orderedCollection.length; i++)\r\n\t\t{\r\n\t\t\tthis.CanvasComponentCollection.orderedCollection[i].Draw();\r\n\t\t}\r\n\t}\r\n\r\n\t// Main component update method and loop\r\n\tUpdate(dt)\r\n\t{\r\n\t\tvar self = this;\r\n\r\n\t\tif(this.mouseState.isDown)\r\n\t\t{\r\n\t\t\tthis.mouseState.downElapsedTime = this.t.time - this.mouseState.downStartTime;\r\n\r\n\t\t\tif(this.mouseState.downElapsedTime > 5 && !this.mouseState.dragEventFired)\r\n\t\t\t{\r\n\t\t\t\tthis.mouseState.dragEventFired = true;\r\n\r\n\t\t\t\t// Get all components under mouse click coordinates\r\n\t\t\t\tthis.componentsDragged = this.GetComponentsAtPoint(this.mouseState.x, this.mouseState.y);\r\n\r\n\t\t\t\t// Set focus of every component to false\r\n\t\t\t\tthis.componentsDragged.forEach(function(component)\r\n\t\t\t\t{\r\n\t\t\t\t\tcomponent.isDragged = true;\r\n\t\t\t\t\tcomponent.relativeMouseX = self.mouseState.x - component.options.x;\r\n\t\t\t\t\tcomponent.relativeMouseY = self.mouseState.y - component.options.y;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor(var component in this.CanvasComponentCollection.collection)\r\n\t\t{\r\n\t\t\tif(!this.CanvasComponentCollection.collection.hasOwnProperty(component))\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tthis.CanvasComponentCollection.collection[component].Update(dt, this.mouseState);\r\n\t\t}\r\n\t}\r\n\r\n\t// Click event handler\r\n\te_onClick(e)\r\n\t{\r\n\t\tvar self = this;\r\n\r\n\t\t// Get all components under mouse click coordinates\r\n\t\tvar components = this.GetComponentsAtPoint(e.clientX, e.clientY);\r\n\r\n\t\t// Set focus of every component to false\r\n\t\tthis.GetComponents().forEach(function(component)\r\n\t\t{\r\n\t\t\tcomponent.hasFocus = false;\r\n\t\t});\r\n\r\n\t\t// Call the click events of all components returned by GetComponentsAtPoint\r\n\t\tcomponents.forEach(function(component)\r\n\t\t{\r\n\t\t\tif(component.ComponentType === CanvasComponent.RADIO)\r\n\t\t\t{\r\n\t\t\t\tself.GetComponentsOfType(CanvasComponent.RADIO).forEach(function(radio)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(radio.GetGroup() === component.GetGroup())\r\n\t\t\t\t\t\tradio.SetState(false);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tcomponent._mouseEvent(ComponentEvent.CLICK, e);\r\n\t\t});\r\n\t}\r\n\r\n\t// Double click event handler\r\n\te_onDblClick(e)\r\n\t{\r\n\t\t\r\n\t}\r\n\r\n\t// Mouse down event handler\r\n\te_mouseDown(e)\r\n\t{\r\n\t\tthis.mouseState.isDown = true;\r\n\t\tthis.mouseState.downStartTime = this.t.time;\r\n\t\tthis.mouseState.ldx = e.clientX;\r\n\t\tthis.mouseState.ldy = e.clientY;\r\n\t}\r\n\r\n\t// Mouse up event handler\r\n\te_mouseUp(e)\r\n\t{\r\n\t\tthis.mouseState.isDown = false;\r\n\t\tthis.mouseState.dragEventFired = false;\r\n\r\n\t\tthis.componentsDragged.forEach(function(component)\r\n\t\t{\r\n\t\t\tcomponent.isDragged = false;\r\n\t\t});\r\n\t}\r\n\r\n\t// Mouse enter event handler\r\n\te_mouseEnter(e)\r\n\t{\r\n\t\t\r\n\t}\r\n\r\n\t// Mouse leave event handler\r\n\te_mouseLeave(e)\r\n\t{\r\n\t\t\r\n\t}\r\n\r\n\t// Mouse over event handler\r\n\te_mouseOver(e)\r\n\t{\r\n\r\n\t}\r\n\r\n\t// Mouse out event handler\r\n\te_mouseOut(e)\r\n\t{\r\n\r\n\t}\r\n\r\n\t// Mouse move event handler\r\n\te_mouseMove(e)\r\n\t{\r\n\t\tthis.mouseState.lx = this.mouseState.x;\r\n\t\tthis.mouseState.ly = this.mouseState.y;\r\n\t\tthis.mouseState.x = e.clientX;\r\n\t\tthis.mouseState.y = e.clientY;\r\n\t\tthis.mouseState.dx = this.mouseState.x - this.mouseState.lx;\r\n\t\tthis.mouseState.dy = this.mouseState.y - this.mouseState.ly;\r\n\r\n\t\t// Should probably move this to Update loop\r\n\t\tthis.GetComponents().forEach(function(component)\r\n\t\t{\r\n\t\t\tif(CCUtil.Collides(component._getBoundingBox(), e.clientX, e.clientY))\r\n\t\t\t{\r\n\t\t\t\tif(!component.isMouseOver)\r\n\t\t\t\t\tcomponent._mouseEvent(ComponentEvent.MOUSE_OVER, e);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tif(component.isMouseOver)\r\n\t\t\t\t\tcomponent._mouseEvent(ComponentEvent.MOUSE_OUT, e);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// Mouse scroll event handler\r\n\te_mouseScroll(e)\r\n\t{\r\n\t\t\r\n\t}\r\n\r\n\t// Top level CanvasComponentCollection methods\r\n\r\n\t// Add component to the collection\r\n\tAddComponent(component)\r\n\t{\r\n\t\tif(this.CanvasComponentCollection.AddComponent(component))\r\n\t\t\treturn component;\r\n\t\telse\r\n\t\t\treturn null;\r\n\t}\r\n\r\n\t// Remove component from the collection\r\n\tRemoveComponent(component)\r\n\t{\r\n\t\treturn this.CanvasComponentCollection.RemoveComponent(component);\r\n\t}\r\n\r\n\t// Find component in the collection by component\r\n\tFindComponent(component)\r\n\t{\r\n\t\treturn this.CanvasComponentCollection.FindComponent(component);\r\n\t}\r\n\r\n\t// Find component in the collection by a component unique id\r\n\tFindComponentById(id)\r\n\t{\r\n\t\treturn this.CanvasComponentCollection.FindComponentById(id);\r\n\t}\r\n\r\n\t// Returns all components whose bounding box collide with given x, y\r\n\tGetComponentsAtPoint(x, y)\r\n\t{\r\n\t\treturn this.CanvasComponentCollection.GetComponentsAtPoint(x, y);\r\n\t}\r\n\r\n\t// Returns all components\r\n\tGetComponents()\r\n\t{\r\n\t\treturn this.CanvasComponentCollection.GetComponents();\r\n\t}\r\n\r\n\tGetComponentsOfType(componentType)\r\n\t{\r\n\t\treturn this.CanvasComponentCollection.GetComponentsOfType(componentType);\r\n\t}\r\n}"]}